#################################################################
# Example render.yaml                                           #
# This file contains configuration for Render services.         #
#################################################################

# Enable preview environments
previews:
  generation: automatic

# List all services here except databases
services:
  # Web service for Node.js application with Playwright
  - type: web
    name: playwright-web
    env: node
    repo: https://github.com/your-repo # Repo chứa mã nguồn của bạn
    buildCommand: |
      npm install
      npx playwright install # Cài đặt Playwright
    startCommand: node server.js # Lệnh khởi động ứng dụng của bạn
    autoDeploy: true
    scaling:
      minInstances: 1
      maxInstances: 3
    envVars:
      - key: NODE_ENV
        value: production
      - key: PLAYWRIGHT_BROWSERS_PATH
        value: /opt/playwright # Đảm bảo Playwright biết đường dẫn trình duyệt
    healthCheckPath: /
    region: oregon

  # Cron job for Playwright automation
  - type: cron
    name: playwright-cron-job
    runtime: python
    schedule: "0 * * * *" # Chạy mỗi giờ
    buildCommand: true
    startCommand: python automate.py # Lệnh để chạy tự động hóa
    repo: https://github.com/your-repo # Repo chứa mã nguồn của bạn

# Define databases here
databases:
  # PostgreSQL database
  - name: my-database
    databaseName: mydb
    user: myuser
    plan: free
    ipAllowList:
      - source: 0.0.0.0/0 # Chấp nhận kết nối từ mọi IP

# Optional environment groups
envVarGroups:
  - name: app-settings
    envVars:
      - key: APP_SECRET
        generateValue: true # Tạo giá trị ngẫu nhiên cho biến môi trường
      - key: API_BASE_URL
        value: https://api.example.com # Địa chỉ API của bạn

